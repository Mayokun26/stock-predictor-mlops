groups:
  - name: mlops_model_performance
    rules:
      - alert: ModelAccuracyDegraded
        expr: model_accuracy < 0.55
        for: 15m
        labels:
          severity: warning
          team: mlops
          category: model_performance
        annotations:
          summary: "Model accuracy has degraded below acceptable threshold"
          description: "Model {{ $labels.model_version }} accuracy is {{ $value | humanizePercentage }}, below 55% threshold"

      - alert: DataDriftDetected
        expr: data_drift_score > 0.25
        for: 10m
        labels:
          severity: warning
          team: mlops
          category: data_quality
        annotations:
          summary: "Significant data drift detected"
          description: "Feature {{ $labels.feature }} shows drift score of {{ $value }}"
          
      - alert: PredictionLatencyHigh
        expr: histogram_quantile(0.95, prediction_request_duration_seconds_bucket) > 0.5
        for: 5m
        labels:
          severity: warning
          team: platform
          category: performance
        annotations:
          summary: "Prediction latency elevated"
          description: "95th percentile prediction latency is {{ $value }}s, above 500ms SLA"

  - name: mlops_business_metrics
    rules:
      - alert: SharpeRatioDeclining
        expr: (sharpe_ratio_metric - sharpe_ratio_metric offset 24h) < -0.5
        for: 30m
        labels:
          severity: warning
          team: quant
          category: risk_management
        annotations:
          summary: "Sharpe ratio declining significantly"
          description: "Portfolio Sharpe ratio declined by {{ $value }} over 24 hours"

      - alert: MaxDrawdownExceeded
        expr: abs(portfolio_max_drawdown) > 0.20
        for: 10m
        labels:
          severity: critical
          team: risk
          category: risk_management
        annotations:
          summary: "CRITICAL: Maximum drawdown exceeded 20%"
          description: "Portfolio drawdown is {{ $value | humanizePercentage }}, exceeding risk limits"